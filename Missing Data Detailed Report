SELECT    TRIALSUBJECT.TRIALSITE as 'Site',PatID as 'Participant ID',
            
                VISITNAME as 'Visit Name',CRFPAGEINSTANCE.VISITCYCLENUMBER as 'Event',CRFPAGEINSTANCE.CRFPAGECYCLENUMBER as 'Follow Up', CRFTITLE as 'Form Name' , DATAITEMNAME as 'Question'
                --COUNT(RESPONSETASKID) AS NUMBEROFVALUES  


FROM 
--replace with the view name contating Cover Information
dbo.R_XXXXX_Cover
,TRIALSUBJECT
,STUDYVISIT
,CRFPAGE
,CRFPAGEINSTANCE
,DATAITEMRESPONSE
,USERROLELOOKUP
,CLINICALTRIAL
,DATAITEM


WHERE TRIALSUBJECT.CLINICALTRIALID = CRFPAGEINSTANCE.CLINICALTRIALID
                --replace with the view name contating Cover Information
                AND TRIALSUBJECT.PersonId = dbo.R_XXXX_Cover.PersonId
                AND TRIALSUBJECT.TRIALSITE = CRFPAGEINSTANCE.TRIALSITE 
                AND TRIALSUBJECT.PERSONID = CRFPAGEINSTANCE.PERSONID
                AND DATAITEMRESPONSE.CLINICALTRIALID = CRFPAGEINSTANCE.CLINICALTRIALID
                AND DATAITEMRESPONSE.TRIALSITE = CRFPAGEINSTANCE.TRIALSITE 
                AND DATAITEMRESPONSE.PERSONID = CRFPAGEINSTANCE.PERSONID
                AND DATAITEMRESPONSE.CRFPAGETASKID = CRFPAGEINSTANCE.CRFPAGETASKID
                AND TRIALSUBJECT.CLINICALTRIALID = CRFPAGE.CLINICALTRIALID
                AND CRFPAGEINSTANCE.CRFPAGEID = CRFPAGE.CRFPAGEID
                AND TRIALSUBJECT.CLINICALTRIALID = STUDYVISIT.CLINICALTRIALID
                AND CRFPAGEINSTANCE.VISITID = STUDYVISIT.VISITID
           
                AND DATAITEMRESPONSE.DATAITEMID = DATAITEM.DATAITEMID
                AND DATAITEMRESPONSE.RESPONSESTATUS = 10 -- Missing
                AND TRIALSUBJECT.CLINICALTRIALID = CLINICALTRIAL.CLINICALTRIALID
                -replace with username that has reports permissions (rde)
                AND USERROLELOOKUP.USERNAME ='XXX'
                AND USERROLELOOKUP.ROLECODE ='fullUser'
                AND USERROLELOOKUP.STUDYID = TRIALSUBJECT.CLINICALTRIALID
                AND USERROLELOOKUP.SITECODE = TRIALSUBJECT.TRIALSITE
                AND TRIALSUBJECT.CLINICALTRIALID = ISNULL('1', TRIALSUBJECT.CLINICALTRIALID)
           
             
GROUP BY
dbo.R_HART_Cover.PatID
,CLINICALTRIAL.CLINICALTRIALNAME
,TRIALSUBJECT.TRIALSITE
,TRIALSUBJECT.PERSONID
,LOCALIDENTIFIER1
,STUDYVISIT.VISITID, 
VISITORDER
,VISITNAME
,CRFPAGE.CRFPAGEID
,CRFPAGEORDER
,CRFTITLE
,DATAITEM.DATAITEMID
,DATAITEM.DATAITEMNAME
,CRFPAGEINSTANCE.CRFPAGECYCLENUMBER
,CRFPAGEINSTANCE.VISITCYCLENUMBER

ORDER BY 
CLINICALTRIALNAME
,TRIALSUBJECT.TRIALSITE
,TRIALSUBJECT.PERSONID
,VISITORDER
,CRFPAGEORDER
,CRFPAGEINSTANCE.CRFPAGECYCLENUMBER
,CRFPAGEINSTANCE.VISITCYCLENUMBER




